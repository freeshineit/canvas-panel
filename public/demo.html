<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>这是一个可以安装到桌面的网页</title>
  <meta name="viewport"
    content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
  <script src="https://unpkg.com/vconsole@latest/dist/vconsole.min.js"></script>
  <script>
    // VConsole will be exported to `window.VConsole` by default.
    var vConsole = new window.VConsole();
  </script>
  <link rel="stylesheet" href="./main.css">
  <link rel="manifest" href="./manifest.json">
</head>

<body>
  <h3 onclick="showNotification()">点击</h3>
  <!-- <div id="installContainer">
    用谷歌浏览器打开，看一下地址栏后面有一个安装的图标，安装一下试试吧
  </div> -->
</body>
<script>
  // 检测浏览器是否支持SW
  if (navigator.serviceWorker != null) {

    function showNotification() {
      console.log("showNotification")
      Notification.requestPermission().then((result) => {
        if (result === "granted") {
          navigator.serviceWorker.ready.then((registration) => {
            registration.showNotification("Vibration Sample", {
              body: "Buzz! Buzz!",
              icon: "./logo.png",
              vibrate: [200, 100, 200, 100, 200, 100, 200],
              tag: "vibration-sample",
            });
          });
        }
        console.log("showNotification result", result)
      });
    }

    navigator.serviceWorker.register('./sw.js')
      .then(function (registartion) {
        console.log('支持sw:', registartion.scope)
        showNotification()

        setInterval(() => {
          showNotification()
        }, 10000)
      })

  } else {
    console.log('不支持SW:')
  }

</script>

</html>